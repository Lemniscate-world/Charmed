# Dissect - Project Rules & Guidelines

> **Instructions for the AI Agent**
> These rules define how we build Dissect. Follow them strictly to maintain the "Strategic Battle Plan" and product quality.

---

## 1. Core Philosophy

### ðŸ‡¨ðŸ‡­ Switzerland Positioning (Neutrality)
- **Rule**: We are framework-agnostic.
- **Implementation**: Never import heavy dependencies (like `langchain`, [crewai](file:///home/kuro/Documents/Dissect/tests/test_parsers.py#25-34), [autogen](file:///home/kuro/Documents/Dissect/tests/test_parsers.py#35-43)) in core modules.
- **Why**: Dissect must be lightweight. Users shouldn't need to install 5GB of AI frameworks just to visualize a trace.

### ðŸŽ¨ Beauty is a Feature
- **Rule**: Visualization outputs must be "Boardroom Ready" (beautiful, dark mode, interactive).
- **Implementation**: Use gradients, animations, and clean typography in HTML exports. No "developer art".
- **Why**: Design is our main differentiator against crude developer tools.

### ðŸš€ Zero-Config Magic
- **Rule**: Things should work without setup.
- **Implementation**: [trace_receiver.py](file:///home/kuro/Documents/Dissect/dissect/trace_receiver.py) must auto-detect formats. CLI must have sensible defaults.

---

## 2. Architecture Rules

### The Graph is the Source of Truth
- All data flows through [OrchestrationGraph](file:///home/kuro/Documents/Dissect/dissect/graph.py#50-200) ([dissect/graph.py](file:///home/kuro/Documents/Dissect/dissect/graph.py)).
- **Flow**: `Raw Trace (JSON)` â†’ [TraceParser](file:///home/kuro/Documents/Dissect/dissect/trace_receiver.py#13-21) â†’ [OrchestrationGraph](file:///home/kuro/Documents/Dissect/dissect/graph.py#50-200) â†’ `Exporter` â†’ [Visual](file:///home/kuro/Documents/Dissect/dissect/viz.py#4-38).
- Never bypass the Graph to go straight from Trace to Visual.

### Loose Coupling
- **Parsers**: Each framework parser ([CrewAIParser](file:///home/kuro/Documents/Dissect/dissect/trace_receiver.py#221-363), [AutoGenParser](file:///home/kuro/Documents/Dissect/dissect/trace_receiver.py#365-468)) should be independent.
- **Exporters**: Exporters should valid for *any* [OrchestrationGraph](file:///home/kuro/Documents/Dissect/dissect/graph.py#50-200), not specific to a framework.

---

## 3. Coding Standards

### Python
- **Type Hinting**: Mandatory for all function signatures.
- **Docstrings**: Required for all classes and public methods.
- **Testing**: Every new parser needs a matching trace file in `examples/` and a unit test in `tests/`.

### Frontend (HTML Exporter)
- **Single File**: Generated HTML must be self-contained (embedded CSS/JS). No external CDNs if possible (for offline support).
- **Performance**: capable of rendering 1000+ nodes without lag (use Canvas/WebGL if DOM gets too heavy, currently SVG is fine for <500).

---

## 4. Workflows

### When Adding a New Framework
1.  Find a sample trace (or generate one).
2.  Create a subclass of [TraceParser](file:///home/kuro/Documents/Dissect/dissect/trace_receiver.py#13-21) in [trace_receiver.py](file:///home/kuro/Documents/Dissect/dissect/trace_receiver.py).
3.  Map framework-specific concepts (Agent, Tool, Task) to Dissect [NodeType](file:///home/kuro/Documents/Dissect/dissect/graph.py#15-22).
4.  Add auto-detection logic to [parse_trace_file](file:///home/kuro/Documents/Dissect/dissect/trace_receiver.py#470-503).
5.  Add a unit test.

### When Modifying Visualization
1.  Edit `HTML_TEMPLATE` in [dissect/exporters/html.py](file:///home/kuro/Documents/Dissect/dissect/exporters/html.py).
2.  Regenerate all example workflows (`examples/*.html`).
3.  Verify interactivity (Zoom/Pan/Play).

---

## 5. Forbidden Patterns ðŸš«
- âŒ Hardcoding framework names in generic visualization logic.
- âŒ Using `print()` for logging (use generic logger or CLI output).
- âŒ Requiring an API key to run basic visualizations.
